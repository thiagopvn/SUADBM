(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{17627:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>B});var s=a(95155),r=a(12115),l=a(69758),o=a(88482),n=a(53999),i=a(55868),c=a(7314),d=a(68500),u=a(39785),x=a(57434);function m(e){let{valorGlobalConsolidado:t,valorEmpenhado:a,valorLiquidadoPago:r,saldoDisponivel:l,totalCreditos:m}=e,h=[{title:"Valor Global Consolidado",value:(0,n.vv)(t),icon:i.A,description:"Total de todos os cr\xe9ditos",color:"text-blue-600"},{title:"Valor Empenhado",value:(0,n.vv)(a),icon:c.A,description:"Recursos j\xe1 comprometidos",color:"text-yellow-600"},{title:"Valor Liquidado/Pago",value:(0,n.vv)(r),icon:d.A,description:"Despesas efetivamente pagas",color:"text-red-600"},{title:"Saldo Dispon\xedvel",value:(0,n.vv)(l),icon:u.A,description:"Valor dispon\xedvel para uso",color:"text-green-600"},{title:"Total de Cr\xe9ditos",value:m.toString(),icon:x.A,description:"N\xfamero de descentraliza\xe7\xf5es",color:"text-purple-600"}];return(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:h.map((e,t)=>{let a=e.icon;return(0,s.jsxs)(o.Zp,{children:[(0,s.jsxs)(o.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(o.ZB,{className:"text-sm font-medium",children:e.title}),(0,s.jsx)(a,{className:"h-4 w-4 ".concat(e.color)})]}),(0,s.jsxs)(o.Wu,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold ".concat(e.color),children:e.value}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},t)})})}var h=a(83540),f=a(93504),g=a(94754),p=a(96025),v=a(16238),b=a(94517),j=a(24026),y=a(21374);function N(e){let{data:t}=e;return(0,s.jsx)(h.u,{width:"100%",height:350,children:(0,s.jsxs)(f.b,{data:t,margin:{top:5,right:30,left:20,bottom:5},children:[(0,s.jsx)(g.d,{strokeDasharray:"3 3"}),(0,s.jsx)(p.W,{dataKey:"ano"}),(0,s.jsx)(v.h,{tickFormatter:e=>(0,n.vv)(e)}),(0,s.jsx)(b.m,{formatter:e=>(0,n.vv)(e),labelFormatter:e=>"Ano: ".concat(e)}),(0,s.jsx)(j.s,{}),(0,s.jsx)(y.N,{type:"monotone",dataKey:"valor",stroke:"#2563eb",name:"Valor Global",strokeWidth:2})]})})}var w=a(8782),C=a(34e3),E=a(54811);let D=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"];function F(e){let{data:t}=e;return(0,s.jsx)(h.u,{width:"100%",height:350,children:(0,s.jsxs)(w.r,{children:[(0,s.jsx)(C.F,{data:t,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{percent:t}=e;return"".concat((100*t).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:t.map((e,t)=>(0,s.jsx)(E.f,{fill:D[t%D.length]},"cell-".concat(t)))}),(0,s.jsx)(b.m,{formatter:e=>(0,n.vv)(e)}),(0,s.jsx)(j.s,{})]})})}var k=a(88145),A=a(89578),S=a(47969),R=a(32401),P=a(80314),J=a(81115);function Z(){let[e,t]=(0,r.useState)("testing"),[a,l]=(0,r.useState)("Testando conex\xe3o com Firebase...");return(0,r.useEffect)(()=>{(async()=>{try{let e=(0,J.KR)(P.O,"test");await (0,J.hZ)(e,{timestamp:Date.now(),message:"Conex\xe3o funcionando!"}),(0,J.Zy)(e,e=>{e.val()&&(t("success"),l("✅ Firebase conectado com sucesso!"))},e=>{t("error"),l("❌ Erro ao ler dados: ".concat(e.message))})}catch(e){t("error"),l("❌ Erro de conex\xe3o: ".concat(e.message))}})()},[]),(0,s.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold mb-2",children:"Teste de Conex\xe3o Firebase"}),(0,s.jsx)("div",{className:"p-3 rounded ".concat("success"===e?"bg-green-100 text-green-800":"error"===e?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:a}),"error"===e&&(0,s.jsxs)("div",{className:"mt-3 text-sm text-gray-600",children:[(0,s.jsx)("p",{children:(0,s.jsx)("strong",{children:"Poss\xedveis solu\xe7\xf5es:"})}),(0,s.jsxs)("ul",{className:"list-disc list-inside mt-1",children:[(0,s.jsx)("li",{children:"Verifique se o Realtime Database foi criado no Console Firebase"}),(0,s.jsx)("li",{children:"Confirme se as regras permitem leitura/escrita"}),(0,s.jsx)("li",{children:"Valide a URL do database na configura\xe7\xe3o"})]})]})]})}function B(){let{creditosWithCalculations:e,loading:t,error:a}=(0,A.$)(),{despesasWithCredits:i,loading:c}=(0,S.G)(),[d,u]=(0,r.useState)({valorGlobalConsolidado:0,valorEmpenhado:0,valorLiquidadoPago:0,saldoDisponivel:0,totalCreditos:0,chartData:[],pieData:[],recentDespesas:[]}),[x,h]=(0,r.useState)(void 0);(0,r.useEffect)(()=>{let t=async()=>{try{let t=await R.J.getDashboardData(x),a=e.filter(e=>!x||e.anoExercicio===x).map(e=>({ano:e.anoExercicio,valor:e.valorGlobal})).sort((e,t)=>e.ano-t.ano),s=new Map;e.filter(e=>!x||e.anoExercicio===x).forEach(e=>{let t=e.valorGlobal/e.eixos.length;e.eixos.forEach(e=>{let a=s.get(e)||0;s.set(e,a+t)})});let r=Array.from(s.entries()).map(e=>{let[t,a]=e;return{name:t.length>30?t.substring(0,30)+"...":t,value:a}}),l=i.filter(t=>!x||t.creditosAssociados.some(t=>{var a;return(null==(a=e.find(e=>e.id===t.creditoId))?void 0:a.anoExercicio)===x})).sort((e,t)=>{let a=e=>{let t=e.fontesDeRecurso.flatMap(e=>[e.dataPagamento,e.dataEmpenho]).filter(e=>!!e);return t.length>0?Math.max(...t.map(e=>new Date(e).getTime())):0};return a(t)-a(e)}).slice(0,5);u({...t,chartData:a,pieData:r,recentDespesas:l})}catch(e){console.error("Error loading dashboard data:",e)}};e.length>0&&t()},[e,i,x]);let f=[...new Set(e.map(e=>e.anoExercicio))].sort((e,t)=>t-e);return t||c?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(l.F,{}),(0,s.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,s.jsx)("div",{className:"px-4 py-6 sm:px-0",children:(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"text-gray-500",children:"Carregando dashboard..."})})})})]}):a?(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(l.F,{}),(0,s.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,s.jsx)("div",{className:"px-4 py-6 sm:px-0",children:(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsxs)("div",{className:"text-red-500",children:["Erro ao carregar dados: ",a]})})})})]}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)(l.F,{}),(0,s.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Dashboard - Vis\xe3o Geral"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Filtro por ano:"}),(0,s.jsxs)("select",{value:x||"todos",onChange:e=>h("todos"===e.target.value?void 0:parseInt(e.target.value)),className:"border rounded-md px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"todos",children:"Todos os anos"}),f.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]})]}),(0,s.jsx)(Z,{}),(0,s.jsx)(m,{valorGlobalConsolidado:d.valorGlobalConsolidado,valorEmpenhado:d.valorEmpenhado,valorLiquidadoPago:d.valorLiquidadoPago,saldoDisponivel:d.saldoDisponivel,totalCreditos:d.totalCreditos}),(0,s.jsxs)("div",{className:"grid gap-6 mt-6 md:grid-cols-2",children:[(0,s.jsxs)(o.Zp,{children:[(0,s.jsx)(o.aR,{children:(0,s.jsx)(o.ZB,{children:"Evolu\xe7\xe3o do Valor Global por Ano"})}),(0,s.jsx)(o.Wu,{children:(0,s.jsx)(N,{data:d.chartData})})]}),(0,s.jsxs)(o.Zp,{children:[(0,s.jsx)(o.aR,{children:(0,s.jsx)(o.ZB,{children:"Distribui\xe7\xe3o por A\xe7\xe3o/Eixo"})}),(0,s.jsx)(o.Wu,{children:(0,s.jsx)(F,{data:d.pieData})})]})]}),(0,s.jsxs)(o.Zp,{className:"mt-6",children:[(0,s.jsx)(o.aR,{children:(0,s.jsx)(o.ZB,{children:"\xdaltimas Despesas Adicionadas"})}),(0,s.jsx)(o.Wu,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[d.recentDespesas.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("p",{className:"font-medium",children:e.objeto}),(0,s.jsx)(k.E,{className:(0,n.qY)(e.status),children:e.status}),e.fontesDeRecurso.length>1&&(0,s.jsxs)(k.E,{variant:"secondary",children:[e.fontesDeRecurso.length," cr\xe9ditos"]})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:[e.processoSEI," • Cr\xe9ditos: ",e.creditosAssociados.map(e=>e.creditoCodigo).join(", ")]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsx)("p",{className:"font-semibold",children:(0,n.vv)(e.valorTotal)}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:(()=>{let t=e.fontesDeRecurso.flatMap(e=>[e.dataPagamento,e.dataEmpenho]).filter(e=>!!e),a=t.length>0?t.reduce((e,t)=>new Date(t)>new Date(e)?t:e):null;return a?(0,n.Yq)(a):"Sem data"})()})]})]},e.id)),0===d.recentDespesas.length&&(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Nenhuma despesa encontrada"})]})})]})]})})]})}},33667:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var s=a(12115),r=a(80314),l=a(16203);function o(){let[e,t]=(0,s.useState)(null),[a,o]=(0,s.useState)(!0),[n,i]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=(0,l.hg)(r.j,e=>{t(e),o(!1)},e=>{i(e.message),o(!1)});return()=>e()},[]),{user:e,loading:a,error:n,logout:(0,s.useCallback)(async()=>{try{i(null),await (0,l.CI)(r.j),window.location.href="/login"}catch(e){throw i(e instanceof Error?e.message:"Failed to logout"),e}},[]),clearError:(0,s.useCallback)(()=>{i(null)},[]),isAuthenticated:!!e}}},47969:(e,t,a)=>{"use strict";a.d(t,{G:()=>l});var s=a(12115),r=a(32401);function l(){let[e,t]=(0,s.useState)({}),[a,l]=(0,s.useState)([]),[o,n]=(0,s.useState)(!0),[i,c]=(0,s.useState)(null),d=(0,s.useCallback)(async()=>{try{n(!0),c(null);let[e,a]=await Promise.all([r.J.getAllDespesas(),r.J.getDespesasWithCreditInfo()]);t(e),l(a)}catch(e){c(e instanceof Error?e.message:"Failed to fetch expenses")}finally{n(!1)}},[]),u=(0,s.useCallback)(async e=>{try{c(null);let t=await r.J.createDespesa(e);return await d(),t}catch(e){throw c(e instanceof Error?e.message:"Failed to create expense"),e}},[d]),x=(0,s.useCallback)(async(e,t)=>{try{c(null),await r.J.updateDespesa(e,t),await d()}catch(e){throw c(e instanceof Error?e.message:"Failed to update expense"),e}},[d]),m=(0,s.useCallback)(async e=>{try{c(null),await r.J.deleteDespesa(e),await d()}catch(e){throw c(e instanceof Error?e.message:"Failed to delete expense"),e}},[d]),h=(0,s.useCallback)(e=>a.filter(t=>t.fontesDeRecurso.some(t=>t.creditoId===e)),[a]),f=(0,s.useCallback)(e=>a.filter(t=>t.status===e),[a]),g=(0,s.useCallback)(e=>a.reduce((t,a)=>{let s=a.fontesDeRecurso.find(t=>t.creditoId===e);return t+(s?s.valorUtilizado:0)},0),[a]);return(0,s.useEffect)(()=>{d()},[d]),{despesas:e,despesasWithCredits:a,loading:o,error:i,refetch:d,createDespesa:u,updateDespesa:x,deleteDespesa:m,getDespesasByCredito:h,getDespesasByStatus:f,getTotalValueByCredito:g}}},53999:(e,t,a)=>{"use strict";a.d(t,{Yq:()=>n,cn:()=>l,qY:()=>i,vv:()=>o});var s=a(52596),r=a(39688);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}function o(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function n(e){return e?new Date(e).toLocaleDateString("pt-BR"):"-"}function i(e){return({Planejado:"bg-gray-100 text-gray-800",Empenhado:"bg-blue-100 text-blue-800",Liquidado:"bg-yellow-100 text-yellow-800",Pago:"bg-green-100 text-green-800",Cancelado:"bg-red-100 text-red-800"})[e]||"bg-gray-100 text-gray-800"}},69758:(e,t,a)=>{"use strict";a.d(t,{F:()=>g});var s=a(95155),r=a(6874),l=a.n(r),o=a(35695),n=a(53999),i=a(33667),c=a(57340),d=a(55868),u=a(47924),x=a(72713),m=a(381),h=a(34835);let f=[{href:"/",label:"Dashboard",icon:c.A},{href:"/creditos",label:"Cr\xe9ditos",icon:d.A},{href:"/rastreamento",label:"Rastreamento",icon:u.A},{href:"/relatorios",label:"Relat\xf3rios",icon:x.A},{href:"/configuracoes",label:"Configura\xe7\xf5es",icon:m.A}];function g(){let e=(0,o.usePathname)(),{logout:t,loading:a}=(0,i.A)(),r=async()=>{if(!a)try{await t()}catch(e){console.error("Logout failed:",e)}};return(0,s.jsx)("nav",{className:"bg-white border-b border-gray-200",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"SICOF - CBMERJ"})}),(0,s.jsx)("div",{className:"hidden sm:ml-8 sm:flex sm:space-x-8",children:f.map(t=>{let a=t.icon,r=e===t.href||"/"!==t.href&&e.startsWith(t.href);return(0,s.jsxs)(l(),{href:t.href,className:(0,n.cn)("inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium",r?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:[(0,s.jsx)(a,{className:"w-4 h-4 mr-2"}),t.label]},t.href)})})]}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("button",{onClick:r,disabled:a,className:"flex items-center text-gray-500 hover:text-gray-700 disabled:opacity-50",children:[(0,s.jsx)(h.A,{className:"w-4 h-4 mr-2"}),a?"Saindo...":"Sair"]})})]})})})}},72609:(e,t,a)=>{Promise.resolve().then(a.bind(a,17627))},88145:(e,t,a)=>{"use strict";a.d(t,{E:()=>o});var s=a(95155),r=a(53999);let l=(0,a(74466).F)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-100 text-green-800",warning:"border-transparent bg-yellow-100 text-yellow-800",info:"border-transparent bg-blue-100 text-blue-800"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,...o}=e;return(0,s.jsx)("div",{className:(0,r.cn)(l({variant:a}),t),...o})}},88482:(e,t,a)=>{"use strict";a.d(t,{Wu:()=>i,ZB:()=>n,Zp:()=>l,aR:()=>o});var s=a(95155),r=a(53999);function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 p-6",t),...a})}function n(e){let{className:t,...a}=e;return(0,s.jsx)("h3",{className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("p-6 pt-0",t),...a})}},89578:(e,t,a)=>{"use strict";a.d(t,{$:()=>l});var s=a(12115),r=a(32401);function l(){let[e,t]=(0,s.useState)({}),[a,l]=(0,s.useState)([]),[o,n]=(0,s.useState)(!0),[i,c]=(0,s.useState)(null),d=(0,s.useCallback)(async()=>{try{n(!0),c(null);let[e,a]=await Promise.all([r.J.getAllCreditos(),r.J.getCreditosWithCalculations()]);t(e),l(a)}catch(e){c(e instanceof Error?e.message:"Failed to fetch credits")}finally{n(!1)}},[]),u=(0,s.useCallback)(async e=>{try{c(null);let t=await r.J.createCredito(e);return await d(),t}catch(e){throw c(e instanceof Error?e.message:"Failed to create credit"),e}},[d]),x=(0,s.useCallback)(async(e,t)=>{try{c(null),await r.J.updateCredito(e,t),await d()}catch(e){throw c(e instanceof Error?e.message:"Failed to update credit"),e}},[d]),m=(0,s.useCallback)(async e=>{try{c(null),await r.J.deleteCredito(e),await d()}catch(e){throw c(e instanceof Error?e.message:"Failed to delete credit"),e}},[d]),h=(0,s.useCallback)(()=>a.filter(e=>e.saldoDisponivel>0),[a]);return(0,s.useEffect)(()=>{d()},[d]),{creditos:e,creditosWithCalculations:a,creditosDisponiveis:h(),loading:o,error:i,refetch:d,createCredito:u,updateCredito:x,deleteCredito:m}}}},e=>{e.O(0,[507,811,814,959,675,401,441,964,358],()=>e(e.s=72609)),_N_E=e.O()}]);