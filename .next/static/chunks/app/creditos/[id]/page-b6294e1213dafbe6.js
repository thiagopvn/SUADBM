(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[750],{75:(e,a,s)=>{Promise.resolve().then(s.bind(s,77664))},33667:(e,a,s)=>{"use strict";s.d(a,{A:()=>o});var t=s(12115),r=s(80314),l=s(16203);function o(){let[e,a]=(0,t.useState)(null),[s,o]=(0,t.useState)(!0),[n,c]=(0,t.useState)(null);return(0,t.useEffect)(()=>{let e=(0,l.hg)(r.j,e=>{a(e),o(!1)},e=>{c(e.message),o(!1)});return()=>e()},[]),{user:e,loading:s,error:n,logout:(0,t.useCallback)(async()=>{try{c(null),await (0,l.CI)(r.j),window.location.href="/login"}catch(e){throw c(e instanceof Error?e.message:"Failed to logout"),e}},[]),clearError:(0,t.useCallback)(()=>{c(null)},[]),isAuthenticated:!!e}}},47969:(e,a,s)=>{"use strict";s.d(a,{G:()=>l});var t=s(12115),r=s(32401);function l(){let[e,a]=(0,t.useState)({}),[s,l]=(0,t.useState)([]),[o,n]=(0,t.useState)(!0),[c,i]=(0,t.useState)(null),d=(0,t.useCallback)(async()=>{try{n(!0),i(null);let[e,s]=await Promise.all([r.J.getAllDespesas(),r.J.getDespesasWithCreditInfo()]);a(e),l(s)}catch(e){i(e instanceof Error?e.message:"Failed to fetch expenses")}finally{n(!1)}},[]),m=(0,t.useCallback)(async e=>{try{i(null);let a=await r.J.createDespesa(e);return await d(),a}catch(e){throw i(e instanceof Error?e.message:"Failed to create expense"),e}},[d]),x=(0,t.useCallback)(async(e,a)=>{try{i(null),await r.J.updateDespesa(e,a),await d()}catch(e){throw i(e instanceof Error?e.message:"Failed to update expense"),e}},[d]),u=(0,t.useCallback)(async e=>{try{i(null),await r.J.deleteDespesa(e),await d()}catch(e){throw i(e instanceof Error?e.message:"Failed to delete expense"),e}},[d]),p=(0,t.useCallback)(e=>s.filter(a=>a.fontesDeRecurso.some(a=>a.creditoId===e)),[s]),h=(0,t.useCallback)(e=>s.filter(a=>a.status===e),[s]),g=(0,t.useCallback)(e=>s.reduce((a,s)=>{let t=s.fontesDeRecurso.find(a=>a.creditoId===e);return a+(t?t.valorUtilizado:0)},0),[s]);return(0,t.useEffect)(()=>{d()},[d]),{despesas:e,despesasWithCredits:s,loading:o,error:c,refetch:d,createDespesa:m,updateDespesa:x,deleteDespesa:u,getDespesasByCredito:p,getDespesasByStatus:h,getTotalValueByCredito:g}}},53999:(e,a,s)=>{"use strict";s.d(a,{Yq:()=>n,cn:()=>l,qY:()=>c,vv:()=>o});var t=s(52596),r=s(39688);function l(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];return(0,r.QP)((0,t.$)(a))}function o(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function n(e){return e?new Date(e).toLocaleDateString("pt-BR"):"-"}function c(e){return({Planejado:"bg-gray-100 text-gray-800",Empenhado:"bg-blue-100 text-blue-800",Liquidado:"bg-yellow-100 text-yellow-800",Pago:"bg-green-100 text-green-800",Cancelado:"bg-red-100 text-red-800"})[e]||"bg-gray-100 text-gray-800"}},69758:(e,a,s)=>{"use strict";s.d(a,{F:()=>g});var t=s(95155),r=s(6874),l=s.n(r),o=s(35695),n=s(53999),c=s(33667),i=s(57340),d=s(55868),m=s(47924),x=s(72713),u=s(381),p=s(34835);let h=[{href:"/",label:"Dashboard",icon:i.A},{href:"/creditos",label:"Cr\xe9ditos",icon:d.A},{href:"/rastreamento",label:"Rastreamento",icon:m.A},{href:"/relatorios",label:"Relat\xf3rios",icon:x.A},{href:"/configuracoes",label:"Configura\xe7\xf5es",icon:u.A}];function g(){let e=(0,o.usePathname)(),{logout:a,loading:s}=(0,c.A)(),r=async()=>{if(!s)try{await a()}catch(e){console.error("Logout failed:",e)}};return(0,t.jsx)("nav",{className:"bg-white border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,t.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"SICOF - CBMERJ"})}),(0,t.jsx)("div",{className:"hidden sm:ml-8 sm:flex sm:space-x-8",children:h.map(a=>{let s=a.icon,r=e===a.href||"/"!==a.href&&e.startsWith(a.href);return(0,t.jsxs)(l(),{href:a.href,className:(0,n.cn)("inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium",r?"border-primary-500 text-gray-900":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:[(0,t.jsx)(s,{className:"w-4 h-4 mr-2"}),a.label]},a.href)})})]}),(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsxs)("button",{onClick:r,disabled:s,className:"flex items-center text-gray-500 hover:text-gray-700 disabled:opacity-50",children:[(0,t.jsx)(p.A,{className:"w-4 h-4 mr-2"}),s?"Saindo...":"Sair"]})})]})})})}},77664:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>M});var t=s(95155),r=s(12115),l=s(35695),o=s(69758),n=s(88482),c=s(88145),i=s(30888),d=s(53999);let m=i.bL,x=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(i.B8,{ref:a,className:(0,d.cn)("inline-flex h-10 items-center justify-center rounded-md bg-gray-100 p-1 text-gray-500",s),...r})});x.displayName=i.B8.displayName;let u=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(i.l9,{ref:a,className:(0,d.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-gray-950 data-[state=active]:shadow-sm",s),...r})});u.displayName=i.l9.displayName;let p=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(i.UC,{ref:a,className:(0,d.cn)("mt-2 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-gray-950 focus-visible:ring-offset-2",s),...r})});p.displayName=i.UC.displayName;var h=s(89578),g=s(47969),f=s(80314),b=s(81115),j=s(32401),v=s(54416),y=s(84616),N=s(62525);function w(e){let{onSubmit:a,onCancel:s,initialData:l,isEditing:o=!1,creditosDisponiveis:n}=e,[c,i]=(0,r.useState)({processoSEI:(null==l?void 0:l.processoSEI)||"",objeto:(null==l?void 0:l.objeto)||"",status:(null==l?void 0:l.status)||"Planejado",dataPrestacaoContas:(null==l?void 0:l.dataPrestacaoContas)||"",prestacaoContasInfo:(null==l?void 0:l.prestacaoContasInfo)||"",metaAssociada:(null==l?void 0:l.metaAssociada)||"",acaoAssociada:(null==l?void 0:l.acaoAssociada)||""}),[d,m]=(0,r.useState)((null==l?void 0:l.fontesDeRecurso)||[{id:"",creditoId:"",valorUtilizado:0,notaEmpenho:"",dataEmpenho:"",ordemBancaria:"",dataPagamento:""}]),[x,u]=(0,r.useState)(!1),[p,h]=(0,r.useState)({}),g=d.reduce((e,a)=>e+a.valorUtilizado,0),f=(e,a,s)=>{let t=[...d];t[e]={...t[e],[a]:s},m(t)},b=e=>{let a=n.find(a=>a.id===e);return(null==a?void 0:a.saldoDisponivel)||0},j=async e=>{if(e.preventDefault(),(()=>{let e={};return c.processoSEI.trim()||(e.processoSEI="Processo SEI \xe9 obrigat\xf3rio"),c.objeto.trim()||(e.objeto="Objeto \xe9 obrigat\xf3rio"),c.metaAssociada.trim()||(e.metaAssociada="Meta associada \xe9 obrigat\xf3ria"),c.acaoAssociada.trim()||(e.acaoAssociada="A\xe7\xe3o associada \xe9 obrigat\xf3ria"),d.forEach((a,s)=>{var t,r;a.creditoId||(e["fonte_".concat(s,"_credito")]="Selecione um cr\xe9dito"),a.valorUtilizado<=0&&(e["fonte_".concat(s,"_valor")]="Valor deve ser maior que zero"),a.creditoId&&a.valorUtilizado>b(a.creditoId)&&(e["fonte_".concat(s,"_valor")]="Valor excede o saldo dispon\xedvel"),"Planejado"!==c.status&&((null==(t=a.notaEmpenho)?void 0:t.trim())||(e["fonte_".concat(s,"_empenho")]="Nota de empenho \xe9 obrigat\xf3ria"),a.dataEmpenho||(e["fonte_".concat(s,"_dataEmpenho")]="Data de empenho \xe9 obrigat\xf3ria")),"Pago"===c.status&&((null==(r=a.ordemBancaria)?void 0:r.trim())||(e["fonte_".concat(s,"_ob")]="Ordem banc\xe1ria \xe9 obrigat\xf3ria"),a.dataPagamento||(e["fonte_".concat(s,"_dataPagamento")]="Data de pagamento \xe9 obrigat\xf3ria"))}),g<=0&&(e.valorTotal="O valor total da despesa deve ser maior que zero"),h(e),0===Object.keys(e).length})())try{u(!0);let e={...c,fontesDeRecurso:d.filter(e=>e.creditoId&&e.valorUtilizado>0),valorTotal:g,dataPrestacaoContas:c.dataPrestacaoContas||null,prestacaoContasInfo:c.prestacaoContasInfo||null};await a(e)}catch(e){console.error("Error submitting form:",e)}finally{u(!1)}},w=(e,a)=>{i(s=>({...s,[e]:a})),p[e]&&h(a=>({...a,[e]:""}))};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-5xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:o?"Editar Despesa":"Nova Despesa"}),(0,t.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:(0,t.jsx)(v.A,{className:"w-5 h-5"})})]}),(0,t.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"border-b pb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informa\xe7\xf5es B\xe1sicas"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Processo SEI *"}),(0,t.jsx)("input",{type:"text",value:c.processoSEI,onChange:e=>w("processoSEI",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(p.processoSEI?"border-red-500":"border-gray-300"),placeholder:"Ex: SEI-270003/000946/2024"}),p.processoSEI&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p.processoSEI})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),(0,t.jsx)("select",{value:c.status,onChange:e=>w("status",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[{value:"Planejado",label:"Planejado"},{value:"Empenhado",label:"Empenhado"},{value:"Liquidado",label:"Liquidado"},{value:"Pago",label:"Pago"},{value:"Cancelado",label:"Cancelado"}].map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Objeto *"}),(0,t.jsx)("textarea",{value:c.objeto,onChange:e=>w("objeto",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(p.objeto?"border-red-500":"border-gray-300"),placeholder:"Descri\xe7\xe3o do objeto da despesa",rows:2}),p.objeto&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p.objeto})]})]}),(0,t.jsxs)("div",{className:"border-b pb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Fontes de Recurso"}),(0,t.jsxs)("button",{type:"button",onClick:()=>{m([...d,{id:"",creditoId:"",valorUtilizado:0,notaEmpenho:"",dataEmpenho:"",ordemBancaria:"",dataPagamento:""}])},className:"flex items-center gap-2 px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[(0,t.jsx)(y.A,{className:"w-4 h-4"}),"Adicionar Fonte"]})]}),(0,t.jsx)("div",{className:"space-y-4",children:d.map((e,a)=>(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,t.jsxs)("h4",{className:"text-sm font-medium text-gray-700",children:["Fonte ",a+1]}),d.length>1&&(0,t.jsx)("button",{type:"button",onClick:()=>{d.length>1&&m(d.filter((e,s)=>s!==a))},className:"text-red-600 hover:text-red-800",children:(0,t.jsx)(N.A,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cr\xe9dito *"}),(0,t.jsxs)("select",{value:e.creditoId,onChange:e=>f(a,"creditoId",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(p["fonte_".concat(a,"_credito")]?"border-red-500":"border-gray-300"),children:[(0,t.jsx)("option",{value:"",children:"Selecione um cr\xe9dito"}),n.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.creditoCodigo," - Saldo: ",e.saldoDisponivel.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]},e.id))]}),p["fonte_".concat(a,"_credito")]&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p["fonte_".concat(a,"_credito")]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor Utilizado (R$) *"}),(0,t.jsx)("input",{type:"number",step:"0.01",value:e.valorUtilizado,onChange:e=>f(a,"valorUtilizado",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(p["fonte_".concat(a,"_valor")]?"border-red-500":"border-gray-300"),min:"0",max:e.creditoId?b(e.creditoId):void 0}),p["fonte_".concat(a,"_valor")]&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p["fonte_".concat(a,"_valor")]}),e.creditoId&&(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Saldo dispon\xedvel: ",b(e.creditoId).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]})]})]}),"Planejado"!==c.status&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nota de Empenho *"}),(0,t.jsx)("input",{type:"text",value:e.notaEmpenho||"",onChange:e=>f(a,"notaEmpenho",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(p["fonte_".concat(a,"_empenho")]?"border-red-500":"border-gray-300"),placeholder:"Ex: 2024NE00123"}),p["fonte_".concat(a,"_empenho")]&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p["fonte_".concat(a,"_empenho")]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Empenho *"}),(0,t.jsx)("input",{type:"date",value:e.dataEmpenho||"",onChange:e=>f(a,"dataEmpenho",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(p["fonte_".concat(a,"_dataEmpenho")]?"border-red-500":"border-gray-300")}),p["fonte_".concat(a,"_dataEmpenho")]&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p["fonte_".concat(a,"_dataEmpenho")]})]})]}),"Pago"===c.status&&(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ordem Banc\xe1ria *"}),(0,t.jsx)("input",{type:"text",value:e.ordemBancaria||"",onChange:e=>f(a,"ordemBancaria",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(p["fonte_".concat(a,"_ob")]?"border-red-500":"border-gray-300"),placeholder:"Ex: 2024OB45678"}),p["fonte_".concat(a,"_ob")]&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p["fonte_".concat(a,"_ob")]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Pagamento *"}),(0,t.jsx)("input",{type:"date",value:e.dataPagamento||"",onChange:e=>f(a,"dataPagamento",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(p["fonte_".concat(a,"_dataPagamento")]?"border-red-500":"border-gray-300")}),p["fonte_".concat(a,"_dataPagamento")]&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p["fonte_".concat(a,"_dataPagamento")]})]})]})]},a))}),(0,t.jsxs)("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Valor Total da Despesa:"}),(0,t.jsx)("span",{className:"text-lg font-bold text-blue-600",children:g.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]}),p.valorTotal&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p.valorTotal})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Outras Informa\xe7\xf5es"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data de Presta\xe7\xe3o de Contas"}),(0,t.jsx)("input",{type:"date",value:c.dataPrestacaoContas,onChange:e=>w("dataPrestacaoContas",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Informa\xe7\xf5es da Presta\xe7\xe3o de Contas"}),(0,t.jsx)("input",{type:"text",value:c.prestacaoContasInfo,onChange:e=>w("prestacaoContasInfo",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Observa\xe7\xf5es sobre a presta\xe7\xe3o de contas"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Meta Associada *"}),(0,t.jsx)("input",{type:"text",value:c.metaAssociada,onChange:e=>w("metaAssociada",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(p.metaAssociada?"border-red-500":"border-gray-300"),placeholder:"Ex: meta_01"}),p.metaAssociada&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p.metaAssociada})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"A\xe7\xe3o Associada *"}),(0,t.jsx)("input",{type:"text",value:c.acaoAssociada,onChange:e=>w("acaoAssociada",e.target.value),className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(p.acaoAssociada?"border-red-500":"border-gray-300"),placeholder:"Ex: acao_01"}),p.acaoAssociada&&(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:p.acaoAssociada})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",disabled:x,children:"Cancelar"}),(0,t.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",disabled:x,children:x?"Salvando...":o?"Salvar Altera\xe7\xf5es":"Criar Despesa"})]})]})]})})}var E=s(81191),C=s(85339),S=s(14186),A=s(57434),P=s(69074),I=s(37108);function k(e){let{prestacoes:a,onGerenciar:s}=e;return 0===a.length?(0,t.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[(0,t.jsx)(A.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Nenhuma presta\xe7\xe3o de contas encontrada para este cr\xe9dito."}),(0,t.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"As presta\xe7\xf5es ser\xe3o geradas automaticamente ap\xf3s o lan\xe7amento do cr\xe9dito."})]}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Per\xedodo"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data de Abertura"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prazo Final"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Processo SEI"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Itens Vinculados"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.periodoLabel}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(P.A,{className:"w-4 h-4"}),(e=>{let a=new Date(new Date(e.prazoFinal));return a.setMonth(a.getMonth()-4),(0,d.Yq)(a.toISOString())})(e)]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,d.Yq)(e.prazoFinal)}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(e=>{let a=new Date().toISOString().split("T")[0];return"Entregue"===e.status?(0,t.jsxs)(c.E,{className:"bg-green-100 text-green-800 hover:bg-green-200",children:[(0,t.jsx)(E.A,{className:"w-3 h-3 mr-1"}),"Entregue"]}):"Pendente"===e.status&&a>e.prazoFinal?(0,t.jsxs)(c.E,{className:"bg-red-100 text-red-800 hover:bg-red-200",children:[(0,t.jsx)(C.A,{className:"w-3 h-3 mr-1"}),"Em Atraso"]}):(0,t.jsxs)(c.E,{className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-200",children:[(0,t.jsx)(S.A,{className:"w-3 h-3 mr-1"}),"Pendente"]})})(e)}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.processoSEI?(0,t.jsxs)("div",{className:"flex items-center gap-1 text-gray-900",children:[(0,t.jsx)(A.A,{className:"w-4 h-4 text-gray-400"}),e.processoSEI]}):(0,t.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(I.A,{className:"w-4 h-4 text-gray-400"}),(0,t.jsxs)("span",{className:e.despesasVinculadas.length>0?"text-gray-900":"text-gray-400",children:[e.despesasVinculadas.length," ",1===e.despesasVinculadas.length?"item":"itens"]})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,t.jsx)("button",{onClick:()=>s(e),className:"text-primary-600 hover:text-primary-900 font-medium",children:"Gerenciar"})})]},e.id))})]})})}var _=s(45584);let D=_.bL;_.l9;let R=_.ZL;_.bm;let F=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(_.hJ,{ref:a,className:(0,d.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});F.displayName=_.hJ.displayName;let z=r.forwardRef((e,a)=>{let{className:s,children:r,...l}=e;return(0,t.jsxs)(R,{children:[(0,t.jsx)(F,{}),(0,t.jsxs)(_.UC,{ref:a,className:(0,d.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...l,children:[r,(0,t.jsxs)(_.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-gray-100 data-[state=open]:text-gray-500",children:[(0,t.jsx)(v.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});z.displayName=_.UC.displayName;let B=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,d.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...s})};B.displayName="DialogHeader";let L=e=>{let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...s})};L.displayName="DialogFooter";let O=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(_.hE,{ref:a,className:(0,d.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});O.displayName=_.hE.displayName;let V=r.forwardRef((e,a)=>{let{className:s,...r}=e;return(0,t.jsx)(_.VY,{ref:a,className:(0,d.cn)("text-sm text-gray-500",s),...r})});V.displayName=_.VY.displayName;var q=s(4229);function J(e){let{open:a,onOpenChange:s,prestacao:l,despesasCredito:o,onSalvar:n}=e,[i,m]=(0,r.useState)(""),[x,u]=(0,r.useState)(""),[p,h]=(0,r.useState)([]),[g,f]=(0,r.useState)(!1),[b,j]=(0,r.useState)("");(0,r.useEffect)(()=>{l&&(m(l.processoSEI||""),u(l.observacoes||""),h(l.despesasVinculadas||[]),j(""))},[l]);let y=async()=>{if(l){if("Entregue"!==l.status&&!i.trim())return void j("O n\xfamero do processo SEI \xe9 obrigat\xf3rio");f(!0),j("");try{await n(l.id,{processoSEI:i.trim(),observacoes:x.trim(),despesasVinculadas:p}),s(!1)}catch(e){j("Erro ao salvar as altera\xe7\xf5es"),console.error(e)}finally{f(!1)}}},N=o.filter(e=>"Pago"===e.status||"Liquidado"===e.status);if(!l)return null;let w="Entregue"===l.status;return(0,t.jsx)(D,{open:a,onOpenChange:s,children:(0,t.jsxs)(z,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(B,{children:[(0,t.jsx)(O,{children:"Gerenciar Presta\xe7\xe3o de Contas"}),(0,t.jsxs)(V,{children:[l.periodoLabel," - Prazo: ",(0,d.Yq)(l.prazoFinal)]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Status:"}),"Entregue"===l.status?(0,t.jsx)(c.E,{className:"bg-green-100 text-green-800",children:"Entregue"}):(0,t.jsx)(c.E,{className:"bg-yellow-100 text-yellow-800",children:"Pendente"})]}),!w&&(0,t.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,t.jsxs)("h3",{className:"text-sm font-semibold text-blue-900 mb-3 flex items-center gap-2",children:[(0,t.jsx)(C.A,{className:"w-4 h-4"}),"Marcar como Entregue"]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"processoSEI",className:"block text-sm font-medium text-gray-700 mb-1",children:"N\xba do Processo SEI *"}),(0,t.jsx)("input",{id:"processoSEI",type:"text",value:i,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Ex: SEI-270042/000123/2024"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"observacoes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Observa\xe7\xf5es (opcional)"}),(0,t.jsx)("textarea",{id:"observacoes",value:x,onChange:e=>u(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Adicione observa\xe7\xf5es relevantes..."})]})]})]}),w&&(0,t.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(A.A,{className:"w-4 h-4 text-green-600"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Processo SEI:"}),(0,t.jsx)("span",{className:"text-sm",children:l.processoSEI})]}),l.dataEntrega&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(P.A,{className:"w-4 h-4 text-green-600"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Data de Entrega:"}),(0,t.jsx)("span",{className:"text-sm",children:(0,d.Yq)(l.dataEntrega)})]}),l.observacoes&&(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Observa\xe7\xf5es:"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:l.observacoes})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,t.jsx)(I.A,{className:"w-4 h-4"}),"Despesas Vinculadas (",p.length,")"]}),0===N.length?(0,t.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Nenhuma despesa eleg\xedvel encontrada. Apenas despesas com status “Liquidado” ou “Pago” podem ser vinculadas."}):(0,t.jsx)("div",{className:"border border-gray-200 rounded-lg max-h-64 overflow-y-auto",children:N.map(e=>(0,t.jsxs)("label",{className:"flex items-center gap-3 p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[(0,t.jsx)("input",{type:"checkbox",checked:p.includes(e.id),onChange:()=>{var a;return a=e.id,void h(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a])},className:"w-4 h-4 text-primary-600 rounded focus:ring-primary-500",disabled:w}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:e.processoSEI}),(0,t.jsx)(c.E,{className:"Pago"===e.status?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800",children:e.status})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 line-clamp-1",children:e.objeto}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 mt-1",children:(0,d.vv)(e.valorTotal)})]})]},e.id))})]}),b&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-md text-sm",children:b})]}),(0,t.jsxs)(L,{className:"mt-6",children:[(0,t.jsxs)("button",{onClick:()=>s(!1),className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-50",disabled:g,children:[(0,t.jsx)(v.A,{className:"w-4 h-4 mr-2 inline"}),"Cancelar"]}),!w&&(0,t.jsxs)("button",{onClick:y,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 disabled:opacity-50",disabled:g,children:[(0,t.jsx)(q.A,{className:"w-4 h-4 mr-2 inline"}),g?"Salvando...":"Salvar e Marcar como Entregue"]})]})]})})}s(38164);var U=s(35169),Z=s(46308),T=s(25273),W=s(47924),Y=s(1482),G=s(13717);function M(){var e;let a=(0,l.useParams)(),s=(0,l.useRouter)(),i=a.id,{creditos:v,creditosDisponiveis:E,loading:C}=(0,h.$)(),{despesasWithCredits:S,createDespesa:A,updateDespesa:P,deleteDespesa:I,getDespesasByCredito:_}=(0,g.G)(),[D,R]=(0,r.useState)(null),[F,z]=(0,r.useState)(null),[B,L]=(0,r.useState)([]),[O,V]=(0,r.useState)([]),[q,M]=(0,r.useState)(""),[$,H]=(0,r.useState)("todos"),[K,Q]=(0,r.useState)(!1),[X,ee]=(0,r.useState)(null),[ea,es]=(0,r.useState)(!1),[et,er]=(0,r.useState)(null),{prestacoes:el,marcarComoEntregue:eo,vincularDespesas:en}=function(e){let[a,s]=(0,r.useState)([]),[t,l]=(0,r.useState)(!0),[o,n]=(0,r.useState)(null);return(0,r.useEffect)(()=>{if(!e){s([]),l(!1);return}let a=(0,b.KR)(f.O,"prestacoesContas");return(0,b.Zy)(a,a=>{try{if(!a.exists()){s([]),l(!1);return}let t=a.val(),r=[];Object.entries(t).forEach(a=>{let[s,t]=a;if(t.creditoId===e){let e=new Date().toISOString().split("T")[0],a=t.status;"Entregue"!==t.status&&e>t.prazoFinal&&(a="Em Atraso"),r.push({...t,id:s,status:a})}}),s(r.sort((e,a)=>e.prazoFinal.localeCompare(a.prazoFinal))),n(null)}catch(e){console.error("Error processing presta\xe7\xf5es:",e),n("Erro ao processar presta\xe7\xf5es de contas")}finally{l(!1)}},e=>{console.error("Firebase error:",e),n("Erro ao carregar presta\xe7\xf5es de contas"),l(!1)}),()=>{(0,b.AU)(a)}},[e]),{prestacoes:a,loading:t,error:o,createPrestacao:async e=>{try{return n(null),await j.J.createPrestacaoContas(e)}catch(e){throw n(e instanceof Error?e.message:"Erro ao criar presta\xe7\xe3o"),e}},updatePrestacao:async(e,a)=>{try{n(null),await j.J.updatePrestacaoContas(e,a)}catch(e){throw n(e instanceof Error?e.message:"Erro ao atualizar presta\xe7\xe3o"),e}},deletePrestacao:async e=>{try{n(null),await j.J.deletePrestacaoContas(e)}catch(e){throw n(e instanceof Error?e.message:"Erro ao deletar presta\xe7\xe3o"),e}},marcarComoEntregue:async(e,a,s)=>{try{n(null),await j.J.updatePrestacaoContas(e,{status:"Entregue",processoSEI:a,observacoes:s,dataEntrega:new Date().toISOString()})}catch(e){throw n(e instanceof Error?e.message:"Erro ao marcar como entregue"),e}},vincularDespesas:async(e,a)=>{try{n(null),await j.J.updatePrestacaoContas(e,{despesasVinculadas:a})}catch(e){throw n(e instanceof Error?e.message:"Erro ao vincular despesas"),e}}}}(i);(0,r.useEffect)(()=>{if(v&&i){let e=v[i];e&&R(e)}},[v,i]),(0,r.useEffect)(()=>{if(E&&i){let e=E.find(e=>e.id===i);e&&z(e)}},[E,i]),(0,r.useEffect)(()=>{if(S&&i){let e=_(i);L(e),V(e)}},[S,i,_]),(0,r.useEffect)(()=>{let e=B;q&&(e=e.filter(e=>e.objeto.toLowerCase().includes(q.toLowerCase())||e.processoSEI.toLowerCase().includes(q.toLowerCase()))),"todos"!==$&&(e=e.filter(e=>e.status===$)),V(e)},[q,$,B]);let ec=async e=>{try{await A(e),Q(!1)}catch(e){console.error("Failed to create despesa:",e)}},ei=async e=>{if(X)try{await P(X.id,e),ee(null)}catch(e){console.error("Failed to update despesa:",e)}},ed=async e=>{if(confirm("Tem certeza que deseja excluir esta despesa?"))try{await I(e)}catch(e){console.error("Failed to delete despesa:",e)}};return C?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(o.F,{}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"px-4 py-6 sm:px-0",children:(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsx)("div",{className:"text-gray-500",children:"Carregando detalhes do cr\xe9dito..."})})})})]}):D?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(o.F,{}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,t.jsxs)("button",{onClick:()=>s.push("/creditos"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[(0,t.jsx)(U.A,{className:"w-4 h-4"}),"Voltar para Cr\xe9ditos"]}),(0,t.jsxs)("div",{className:"bg-white shadow-sm rounded-lg p-6 mb-6",children:[(0,t.jsx)("div",{className:"flex justify-between items-start",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:D.creditoCodigo}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mb-4",children:D.eixos.map((e,a)=>(0,t.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e.split("(")[0].trim()},a))}),(0,t.jsxs)("div",{className:"flex gap-4 text-sm text-gray-500",children:[(0,t.jsxs)("span",{children:["Ano: ",D.anoExercicio]}),(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{children:["Natureza: ",D.natureza]}),(0,t.jsx)("span",{children:"•"}),(0,t.jsxs)("span",{children:["Origem: ",(null==(e=D.origem)?void 0:e.tipo)==="Ano vigente"?"Ano vigente":"Anos anteriores"]})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-6",children:[(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{className:"pb-2",children:(0,t.jsx)(n.ZB,{className:"text-sm font-medium text-gray-600",children:"Valor Global"})}),(0,t.jsx)(n.Wu,{children:(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:(0,d.vv)(D.valorGlobal)})})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{className:"pb-2",children:(0,t.jsx)(n.ZB,{className:"text-sm font-medium text-gray-600",children:"Valor Empenhado"})}),(0,t.jsx)(n.Wu,{children:(0,t.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:(0,d.vv)((null==F?void 0:F.valorEmpenhado)||0)})})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{className:"pb-2",children:(0,t.jsx)(n.ZB,{className:"text-sm font-medium text-gray-600",children:"Valor Pago"})}),(0,t.jsx)(n.Wu,{children:(0,t.jsx)("p",{className:"text-2xl font-bold text-red-600",children:(0,d.vv)((null==F?void 0:F.valorPago)||0)})})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{className:"pb-2",children:(0,t.jsx)(n.ZB,{className:"text-sm font-medium text-gray-600",children:"Saldo Dispon\xedvel"})}),(0,t.jsx)(n.Wu,{children:(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:(0,d.vv)((null==F?void 0:F.saldoDisponivel)||0)})})]})]})]}),(0,t.jsxs)(m,{defaultValue:"despesas",className:"w-full",children:[(0,t.jsxs)(x,{className:"grid w-full grid-cols-2",children:[(0,t.jsxs)(u,{value:"despesas",className:"flex items-center gap-2",children:[(0,t.jsx)(Z.A,{className:"w-4 h-4"}),"Despesas"]}),(0,t.jsxs)(u,{value:"prestacao-contas",className:"flex items-center gap-2",children:[(0,t.jsx)(T.A,{className:"w-4 h-4"}),"Presta\xe7\xe3o de Contas"]})]}),(0,t.jsx)(p,{value:"despesas",children:(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)(n.ZB,{children:"Despesas"}),(0,t.jsxs)("button",{onClick:()=>Q(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center gap-2",children:[(0,t.jsx)(y.A,{className:"w-4 h-4"}),"Adicionar Nova Despesa"]})]})}),(0,t.jsxs)(n.Wu,{children:[(0,t.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)(W.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,t.jsx)("input",{type:"text",placeholder:"Pesquisar por objeto ou processo SEI...",className:"w-full pl-10 pr-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",value:q,onChange:e=>M(e.target.value)})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(Y.A,{className:"text-gray-400 w-4 h-4"}),(0,t.jsxs)("select",{className:"border rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",value:$,onChange:e=>H(e.target.value),children:[(0,t.jsx)("option",{value:"todos",children:"Todos os status"}),(0,t.jsx)("option",{value:"Planejado",children:"Planejado"}),(0,t.jsx)("option",{value:"Empenhado",children:"Empenhado"}),(0,t.jsx)("option",{value:"Liquidado",children:"Liquidado"}),(0,t.jsx)("option",{value:"Pago",children:"Pago"}),(0,t.jsx)("option",{value:"Cancelado",children:"Cancelado"})]})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:0===O.length?(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:0===B.length?"Nenhuma despesa encontrada. Adicione a primeira despesa!":"Nenhuma despesa corresponde aos filtros aplicados."}):O.map(e=>{let a=e.fontesDeRecurso.find(e=>e.creditoId===i);return(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)(c.E,{className:(0,d.qY)(e.status),children:e.status}),e.fontesDeRecurso.length>1&&(0,t.jsxs)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:[e.fontesDeRecurso.length," fontes de financiamento"]})]}),(0,t.jsx)("h3",{className:"font-medium text-gray-900 mb-1",children:e.objeto}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["SEI: ",e.processoSEI]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>ee(e),className:"text-indigo-600 hover:text-indigo-900 p-1",children:(0,t.jsx)(G.A,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>ed(e.id),className:"text-red-600 hover:text-red-900 p-1",children:(0,t.jsx)(N.A,{className:"w-4 h-4"})})]})]}),(0,t.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 mb-3",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Participa\xe7\xe3o deste Cr\xe9dito"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-blue-700",children:"Valor Financiado:"}),(0,t.jsx)("p",{className:"font-semibold text-blue-900",children:(0,d.vv)((null==a?void 0:a.valorUtilizado)||0)}),(0,t.jsxs)("p",{className:"text-xs text-blue-600",children:["de ",(0,d.vv)(e.valorTotal)," total (",(((null==a?void 0:a.valorUtilizado)||0)/e.valorTotal*100).toFixed(1),"%)"]})]}),(null==a?void 0:a.notaEmpenho)&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-blue-700",children:"Nota de Empenho:"}),(0,t.jsx)("p",{className:"font-semibold text-blue-900",children:a.notaEmpenho}),a.dataEmpenho&&(0,t.jsx)("p",{className:"text-xs text-blue-600",children:new Date(a.dataEmpenho).toLocaleDateString("pt-BR")})]}),(null==a?void 0:a.ordemBancaria)&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs text-blue-700",children:"Ordem Banc\xe1ria:"}),(0,t.jsx)("p",{className:"font-semibold text-blue-900",children:a.ordemBancaria}),a.dataPagamento&&(0,t.jsx)("p",{className:"text-xs text-blue-600",children:new Date(a.dataPagamento).toLocaleDateString("pt-BR")})]})]})]}),e.fontesDeRecurso.length>1&&(0,t.jsxs)("div",{className:"bg-gray-100 rounded-lg p-3",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Outras Fontes de Financiamento"}),(0,t.jsx)("div",{className:"space-y-2",children:e.fontesDeRecurso.filter(e=>e.creditoId!==i).map((a,s)=>{let r=e.creditosAssociados.find(e=>e.creditoId===a.creditoId);return(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,t.jsx)("span",{className:"text-gray-600",children:(null==r?void 0:r.creditoCodigo)||"Cr\xe9dito desconhecido"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:(0,d.vv)(a.valorUtilizado)})]},s)})})]})]},e.id)})})]})]})}),(0,t.jsx)(p,{value:"prestacao-contas",children:(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"Controle de Presta\xe7\xe3o de Contas"})}),(0,t.jsx)(n.Wu,{children:(0,t.jsx)(k,{prestacoes:el,onGerenciar:e=>{er(e),es(!0)}})})]})})]})]})}),K&&(0,t.jsx)(w,{onSubmit:ec,onCancel:()=>Q(!1),creditosDisponiveis:E}),X&&(0,t.jsx)(w,{onSubmit:ei,onCancel:()=>ee(null),initialData:X,isEditing:!0,creditosDisponiveis:E}),(0,t.jsx)(J,{open:ea,onOpenChange:es,prestacao:et,despesasCredito:B,onSalvar:async(e,a)=>{a.despesasVinculadas&&await en(e,a.despesasVinculadas),a.processoSEI&&await eo(e,a.processoSEI,a.observacoes)}})]}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(o.F,{}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"px-4 py-6 sm:px-0",children:(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsx)("div",{className:"text-red-500",children:"Cr\xe9dito n\xe3o encontrado!"})})})})]})}},88145:(e,a,s)=>{"use strict";s.d(a,{E:()=>o});var t=s(95155),r=s(53999);let l=(0,s(74466).F)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-100 text-green-800",warning:"border-transparent bg-yellow-100 text-yellow-800",info:"border-transparent bg-blue-100 text-blue-800"}},defaultVariants:{variant:"default"}});function o(e){let{className:a,variant:s,...o}=e;return(0,t.jsx)("div",{className:(0,r.cn)(l({variant:s}),a),...o})}},88482:(e,a,s)=>{"use strict";s.d(a,{Wu:()=>c,ZB:()=>n,Zp:()=>l,aR:()=>o});var t=s(95155),r=s(53999);function l(e){let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})}function o(e){let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...s})}function n(e){let{className:a,...s}=e;return(0,t.jsx)("h3",{className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})}function c(e){let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,r.cn)("p-6 pt-0",a),...s})}},89578:(e,a,s)=>{"use strict";s.d(a,{$:()=>l});var t=s(12115),r=s(32401);function l(){let[e,a]=(0,t.useState)({}),[s,l]=(0,t.useState)([]),[o,n]=(0,t.useState)(!0),[c,i]=(0,t.useState)(null),d=(0,t.useCallback)(async()=>{try{n(!0),i(null);let[e,s]=await Promise.all([r.J.getAllCreditos(),r.J.getCreditosWithCalculations()]);a(e),l(s)}catch(e){i(e instanceof Error?e.message:"Failed to fetch credits")}finally{n(!1)}},[]),m=(0,t.useCallback)(async e=>{try{i(null);let a=await r.J.createCredito(e);return await d(),a}catch(e){throw i(e instanceof Error?e.message:"Failed to create credit"),e}},[d]),x=(0,t.useCallback)(async(e,a)=>{try{i(null),await r.J.updateCredito(e,a),await d()}catch(e){throw i(e instanceof Error?e.message:"Failed to update credit"),e}},[d]),u=(0,t.useCallback)(async e=>{try{i(null),await r.J.deleteCredito(e),await d()}catch(e){throw i(e instanceof Error?e.message:"Failed to delete credit"),e}},[d]),p=(0,t.useCallback)(()=>s.filter(e=>e.saldoDisponivel>0),[s]);return(0,t.useEffect)(()=>{d()},[d]),{creditos:e,creditosWithCalculations:s,creditosDisponiveis:p(),loading:o,error:c,refetch:d,createCredito:m,updateCredito:x,deleteCredito:u}}}},e=>{e.O(0,[507,811,814,959,403,401,441,964,358],()=>e(e.s=75)),_N_E=e.O()}]);