(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{17627:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>P});var t=s(95155),r=s(12115),l=s(69758),o=s(88482),i=s(53999),n=s(55868),c=s(7314),d=s(68500),u=s(39785),x=s(57434);function m(e){let{valorGlobalConsolidado:a,valorEmpenhado:s,valorLiquidadoPago:r,saldoDisponivel:l,totalCreditos:m}=e,h=[{title:"Valor Global Consolidado",value:(0,i.vv)(a),icon:n.A,description:"Total de todos os cr\xe9ditos",color:"text-blue-600"},{title:"Valor Empenhado",value:(0,i.vv)(s),icon:c.A,description:"Recursos j\xe1 comprometidos",color:"text-yellow-600"},{title:"Valor Liquidado/Pago",value:(0,i.vv)(r),icon:d.A,description:"Despesas efetivamente pagas",color:"text-red-600"},{title:"Saldo Dispon\xedvel",value:(0,i.vv)(l),icon:u.A,description:"Valor dispon\xedvel para uso",color:"text-green-600"},{title:"Total de Cr\xe9ditos",value:m.toString(),icon:x.A,description:"N\xfamero de descentraliza\xe7\xf5es",color:"text-purple-600"}];return(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:h.map((e,a)=>{let s=e.icon;return(0,t.jsxs)(o.Zp,{children:[(0,t.jsxs)(o.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(o.ZB,{className:"text-sm font-medium",children:e.title}),(0,t.jsx)(s,{className:"h-4 w-4 ".concat(e.color)})]}),(0,t.jsxs)(o.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold ".concat(e.color),children:e.value}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]},a)})})}var h=s(83540),p=s(93504),f=s(94754),g=s(96025),v=s(16238),j=s(94517),b=s(24026),y=s(21374);function N(e){let{data:a}=e;return(0,t.jsx)(h.u,{width:"100%",height:350,children:(0,t.jsxs)(p.b,{data:a,margin:{top:5,right:30,left:20,bottom:5},children:[(0,t.jsx)(f.d,{strokeDasharray:"3 3"}),(0,t.jsx)(g.W,{dataKey:"ano"}),(0,t.jsx)(v.h,{tickFormatter:e=>(0,i.vv)(e)}),(0,t.jsx)(j.m,{formatter:e=>(0,i.vv)(e),labelFormatter:e=>"Ano: ".concat(e)}),(0,t.jsx)(b.s,{}),(0,t.jsx)(y.N,{type:"monotone",dataKey:"valor",stroke:"#2563eb",name:"Valor Global",strokeWidth:2})]})})}var w=s(8782),E=s(34e3),C=s(54811);let D=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8"];function F(e){let{data:a}=e;return(0,t.jsx)(h.u,{width:"100%",height:350,children:(0,t.jsxs)(w.r,{children:[(0,t.jsx)(E.F,{data:a,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{percent:a}=e;return"".concat((100*a).toFixed(0),"%")},outerRadius:80,fill:"#8884d8",dataKey:"value",children:a.map((e,a)=>(0,t.jsx)(C.f,{fill:D[a%D.length]},"cell-".concat(a)))}),(0,t.jsx)(j.m,{formatter:e=>(0,i.vv)(e)}),(0,t.jsx)(b.s,{})]})})}var k=s(88145),S=s(89578),R=s(47969),A=s(32401),G=s(80314),Z=s(81115);function J(){let[e,a]=(0,r.useState)("testing"),[s,l]=(0,r.useState)("Testando conex\xe3o com Firebase...");return(0,r.useEffect)(()=>{(async()=>{try{let e=(0,Z.KR)(G.O,"test");await (0,Z.hZ)(e,{timestamp:Date.now(),message:"Conex\xe3o funcionando!"}),(0,Z.Zy)(e,e=>{e.val()&&(a("success"),l("✅ Firebase conectado com sucesso!"))},e=>{a("error"),l("❌ Erro ao ler dados: ".concat(e.message))})}catch(e){a("error"),l("❌ Erro de conex\xe3o: ".concat(e.message))}})()},[]),(0,t.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,t.jsx)("h3",{className:"font-semibold mb-2",children:"Teste de Conex\xe3o Firebase"}),(0,t.jsx)("div",{className:"p-3 rounded ".concat("success"===e?"bg-green-100 text-green-800":"error"===e?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:s}),"error"===e&&(0,t.jsxs)("div",{className:"mt-3 text-sm text-gray-600",children:[(0,t.jsx)("p",{children:(0,t.jsx)("strong",{children:"Poss\xedveis solu\xe7\xf5es:"})}),(0,t.jsxs)("ul",{className:"list-disc list-inside mt-1",children:[(0,t.jsx)("li",{children:"Verifique se o Realtime Database foi criado no Console Firebase"}),(0,t.jsx)("li",{children:"Confirme se as regras permitem leitura/escrita"}),(0,t.jsx)("li",{children:"Valide a URL do database na configura\xe7\xe3o"})]})]})]})}function P(){let{creditosWithCalculations:e,loading:a,error:s}=(0,S.$)(),{despesasWithCredits:n,loading:c}=(0,R.G)(),[d,u]=(0,r.useState)({valorGlobalConsolidado:0,valorEmpenhado:0,valorLiquidadoPago:0,saldoDisponivel:0,totalCreditos:0,chartData:[],pieData:[],recentDespesas:[]}),[x,h]=(0,r.useState)(void 0);(0,r.useEffect)(()=>{let a=async()=>{try{let a=await A.J.getDashboardData(x),s=e.filter(e=>!x||e.anoExercicio===x).map(e=>({ano:e.anoExercicio,valor:e.valorGlobal})).sort((e,a)=>e.ano-a.ano),t=new Map;e.filter(e=>!x||e.anoExercicio===x).forEach(e=>{let a=e.eixos||[],s=a.length>0?e.valorGlobal/a.length:e.valorGlobal;if(a.length>0)a.forEach(e=>{let a=t.get(e)||0;t.set(e,a+s)});else{let a=t.get("Sem eixo definido")||0;t.set("Sem eixo definido",a+e.valorGlobal)}});let r=Array.from(t.entries()).map(e=>{let[a,s]=e;return{name:a.length>30?a.substring(0,30)+"...":a,value:s}}),l=n.filter(a=>!x||a.creditosAssociados.some(a=>{var s;return(null==(s=e.find(e=>e.id===a.creditoId))?void 0:s.anoExercicio)===x})).sort((e,a)=>{let s=e=>{let a=e.fontesDeRecurso.flatMap(e=>[e.dataPagamento,e.dataEmpenho]).filter(e=>!!e);return a.length>0?Math.max(...a.map(e=>new Date(e).getTime())):0};return s(a)-s(e)}).slice(0,5);u({...a,chartData:s,pieData:r,recentDespesas:l})}catch(e){console.error("Error loading dashboard data:",e)}};e.length>0&&a()},[e,n,x]);let p=[...new Set(e.map(e=>e.anoExercicio))].sort((e,a)=>a-e);return a||c?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(l.F,{}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"px-4 py-6 sm:px-0",children:(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsx)("div",{className:"text-gray-500",children:"Carregando dashboard..."})})})})]}):s?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(l.F,{}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"px-4 py-6 sm:px-0",children:(0,t.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,t.jsxs)("div",{className:"text-red-500",children:["Erro ao carregar dados: ",s]})})})})]}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(l.F,{}),(0,t.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold text-gray-900",children:"Dashboard - Vis\xe3o Geral"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Filtro por ano:"}),(0,t.jsxs)("select",{value:x||"todos",onChange:e=>h("todos"===e.target.value?void 0:parseInt(e.target.value)),className:"border rounded-md px-3 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"todos",children:"Todos os anos"}),p.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]})]}),(0,t.jsx)(J,{}),(0,t.jsx)(m,{valorGlobalConsolidado:d.valorGlobalConsolidado,valorEmpenhado:d.valorEmpenhado,valorLiquidadoPago:d.valorLiquidadoPago,saldoDisponivel:d.saldoDisponivel,totalCreditos:d.totalCreditos}),(0,t.jsxs)("div",{className:"grid gap-6 mt-6 md:grid-cols-2",children:[(0,t.jsxs)(o.Zp,{children:[(0,t.jsx)(o.aR,{children:(0,t.jsx)(o.ZB,{children:"Evolu\xe7\xe3o do Valor Global por Ano"})}),(0,t.jsx)(o.Wu,{children:(0,t.jsx)(N,{data:d.chartData})})]}),(0,t.jsxs)(o.Zp,{children:[(0,t.jsx)(o.aR,{children:(0,t.jsx)(o.ZB,{children:"Distribui\xe7\xe3o por A\xe7\xe3o/Eixo"})}),(0,t.jsx)(o.Wu,{children:(0,t.jsx)(F,{data:d.pieData})})]})]}),(0,t.jsxs)(o.Zp,{className:"mt-6",children:[(0,t.jsx)(o.aR,{children:(0,t.jsx)(o.ZB,{children:"\xdaltimas Despesas Adicionadas"})}),(0,t.jsx)(o.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[d.recentDespesas.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"font-medium",children:e.objeto}),(0,t.jsx)(k.E,{className:(0,i.qY)(e.status),children:e.status}),e.fontesDeRecurso.length>1&&(0,t.jsxs)(k.E,{variant:"secondary",children:[e.fontesDeRecurso.length," cr\xe9ditos"]})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[e.processoSEI," • Cr\xe9ditos: ",e.creditosAssociados.map(e=>e.creditoCodigo).join(", ")]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"font-semibold",children:(0,i.vv)(e.valorTotal)}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:(()=>{let a=e.fontesDeRecurso.flatMap(e=>[e.dataPagamento,e.dataEmpenho]).filter(e=>!!e),s=a.length>0?a.reduce((e,a)=>new Date(a)>new Date(e)?a:e):null;return s?(0,i.Yq)(s):"Sem data"})()})]})]},e.id)),0===d.recentDespesas.length&&(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Nenhuma despesa encontrada"})]})})]})]})})]})}},47969:(e,a,s)=>{"use strict";s.d(a,{G:()=>l});var t=s(12115),r=s(32401);function l(){let[e,a]=(0,t.useState)({}),[s,l]=(0,t.useState)([]),[o,i]=(0,t.useState)(!0),[n,c]=(0,t.useState)(null),d=(0,t.useCallback)(async()=>{try{i(!0),c(null);let[e,s]=await Promise.all([r.J.getAllDespesas(),r.J.getDespesasWithCreditInfo()]);a(e),l(s)}catch(e){c(e instanceof Error?e.message:"Failed to fetch expenses")}finally{i(!1)}},[]),u=(0,t.useCallback)(async e=>{try{c(null);let a=await r.J.createDespesa(e);return await d(),a}catch(e){throw c(e instanceof Error?e.message:"Failed to create expense"),e}},[d]),x=(0,t.useCallback)(async(e,a)=>{try{c(null),await r.J.updateDespesa(e,a),await d()}catch(e){throw c(e instanceof Error?e.message:"Failed to update expense"),e}},[d]),m=(0,t.useCallback)(async e=>{try{c(null),await r.J.deleteDespesa(e),await d()}catch(e){throw c(e instanceof Error?e.message:"Failed to delete expense"),e}},[d]),h=(0,t.useCallback)(e=>s.filter(a=>a.fontesDeRecurso.some(a=>a.creditoId===e)),[s]),p=(0,t.useCallback)(e=>s.filter(a=>a.status===e),[s]),f=(0,t.useCallback)(e=>s.reduce((a,s)=>{let t=s.fontesDeRecurso.find(a=>a.creditoId===e);return a+(t?t.valorUtilizado:0)},0),[s]);return(0,t.useEffect)(()=>{d()},[d]),{despesas:e,despesasWithCredits:s,loading:o,error:n,refetch:d,createDespesa:u,updateDespesa:x,deleteDespesa:m,getDespesasByCredito:h,getDespesasByStatus:p,getTotalValueByCredito:f}}},72609:(e,a,s)=>{Promise.resolve().then(s.bind(s,17627))},88145:(e,a,s)=>{"use strict";s.d(a,{E:()=>o});var t=s(95155),r=s(53999);let l=(0,s(74466).F)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-100 text-green-800",warning:"border-transparent bg-yellow-100 text-yellow-800",info:"border-transparent bg-blue-100 text-blue-800"}},defaultVariants:{variant:"default"}});function o(e){let{className:a,variant:s,...o}=e;return(0,t.jsx)("div",{className:(0,r.cn)(l({variant:s}),a),...o})}},88482:(e,a,s)=>{"use strict";s.d(a,{Wu:()=>n,ZB:()=>i,Zp:()=>l,aR:()=>o});var t=s(95155),r=s(53999);function l(e){let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})}function o(e){let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...s})}function i(e){let{className:a,...s}=e;return(0,t.jsx)("h3",{className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})}function n(e){let{className:a,...s}=e;return(0,t.jsx)("div",{className:(0,r.cn)("p-6 pt-0",a),...s})}},89578:(e,a,s)=>{"use strict";s.d(a,{$:()=>l});var t=s(12115),r=s(32401);function l(){let[e,a]=(0,t.useState)({}),[s,l]=(0,t.useState)([]),[o,i]=(0,t.useState)(!0),[n,c]=(0,t.useState)(null),d=(0,t.useCallback)(async()=>{try{i(!0),c(null);let[e,s]=await Promise.all([r.J.getAllCreditos(),r.J.getCreditosWithCalculations()]);a(e),l(s)}catch(e){c(e instanceof Error?e.message:"Failed to fetch credits")}finally{i(!1)}},[]),u=(0,t.useCallback)(async e=>{try{c(null);let a=await r.J.createCredito(e);return await d(),a}catch(e){throw c(e instanceof Error?e.message:"Failed to create credit"),e}},[d]),x=(0,t.useCallback)(async(e,a)=>{try{c(null),await r.J.updateCredito(e,a),await d()}catch(e){throw c(e instanceof Error?e.message:"Failed to update credit"),e}},[d]),m=(0,t.useCallback)(async e=>{try{c(null),await r.J.deleteCredito(e),await d()}catch(e){throw c(e instanceof Error?e.message:"Failed to delete credit"),e}},[d]),h=(0,t.useCallback)(()=>s.filter(e=>e.saldoDisponivel>0),[s]);return(0,t.useEffect)(()=>{d()},[d]),{creditos:e,creditosWithCalculations:s,creditosDisponiveis:h(),loading:o,error:n,refetch:d,createCredito:u,updateCredito:x,deleteCredito:m}}}},e=>{e.O(0,[507,811,456,675,960,441,964,358],()=>e(e.s=72609)),_N_E=e.O()}]);